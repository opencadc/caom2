name: Java CI

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Set up JDK 11
      uses: actions/setup-java@v1
      with:
        java-version: 11
  
    - name: build and test caom2
      run: cd caom2 && ../gradlew --info clean build javadoc checkstyleMain install
      
    - name: build and test caom2-compute
      run: cd caom2-compute && ../gradlew --info clean assemble javadoc checkstyleMain install
    
    - name: build and test caom2-artifact-resolvers
      run: cd caom2-artifact-resolvers && ../gradlew --info clean assemble javadoc checkstyleMain install

    - name: build and test caom2-validator
      run: cd caom2-validator && ../gradlew --info clean build

# not ported to caom25 yet
#    - name: build and test caom2-viz
#      run: cd caom2-viz && ../gradlew --info clean build

# obsolete
#    - name: build and test fits2caom2
#      run: cd fits2caom2 && ../gradlew --info clean build javadoc install
    

